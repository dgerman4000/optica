{"version":3,"sources":["webpack://living-atlas-optica/webpack/runtime/chunk loaded","webpack://living-atlas-optica/./src/utils/URLHashParams.ts","webpack://living-atlas-optica/./src/store/reducers/UI.ts","webpack://living-atlas-optica/./src/constants/map.ts","webpack://living-atlas-optica/./src/utils/esri-oauth/index.ts","webpack://living-atlas-optica/./src/store/reducers/Map.ts","webpack://living-atlas-optica/./src/store/reducers/rootReducer.ts","webpack://living-atlas-optica/./src/store/getPreloadedState.ts","webpack://living-atlas-optica/./src/store/configureStore.ts","webpack://living-atlas-optica/./src/contexts/AppContextProvider.tsx","webpack://living-atlas-optica/./src/contexts/EsriOAuthProvider.tsx","webpack://living-atlas-optica/./src/components/AppLayout/AppLayout.tsx","webpack://living-atlas-optica/./src/components/ControlPanel/ToggleBtn.tsx","webpack://living-atlas-optica/./src/components/ControlPanel/PanelConfiguration.tsx","webpack://living-atlas-optica/./src/static/imagery.jpg","webpack://living-atlas-optica/./src/static/hybrid.jpg","webpack://living-atlas-optica/./src/static/human-geo-light.jpg","webpack://living-atlas-optica/./src/static/human-geo-dark.jpg","webpack://living-atlas-optica/./src/static/topo.jpg","webpack://living-atlas-optica/./src/static/vibrant.png","webpack://living-atlas-optica/./src/components/ControlPanel/WebMapSelector.tsx","webpack://living-atlas-optica/./src/hooks/useOnClickOutside.tsx","webpack://living-atlas-optica/./src/components/ControlPanel/OAuthControl.tsx","webpack://living-atlas-optica/./src/components/ControlPanel/ControlPanel.tsx","webpack://living-atlas-optica/./src/components/ControlPanel/ControlPanelContainer.tsx","webpack://living-atlas-optica/./src/components/ArcGIS/MapView.tsx","webpack://living-atlas-optica/./src/components/MapPanels/ExtentBox.tsx","webpack://living-atlas-optica/./src/components/MapPanels/MapPanel.tsx","webpack://living-atlas-optica/./src/components/MapPanels/ZoomLock.tsx","webpack://living-atlas-optica/./src/components/MapPanels/ScaleIndicator.tsx","webpack://living-atlas-optica/./src/components/MapPanels/MapPanelsContainer.tsx","webpack://living-atlas-optica/./src/index.tsx","webpack://living-atlas-optica/webpack/bootstrap","webpack://living-atlas-optica/webpack/runtime/compat get default export","webpack://living-atlas-optica/webpack/runtime/define property getters","webpack://living-atlas-optica/webpack/runtime/global","webpack://living-atlas-optica/webpack/runtime/hasOwnProperty shorthand","webpack://living-atlas-optica/webpack/runtime/publicPath","webpack://living-atlas-optica/webpack/runtime/jsonp chunk loading","webpack://living-atlas-optica/webpack/startup"],"names":["deferred","DEFAULT_HASH_PARAMS","urlFns","setHashParam","key","value","initialUIState","mapPanelsInfo","direction","num","isControlPanelVisible","slice","createSlice","name","initialState","reducers","mapPanelsInfoChanged","state","action","payload","isControlPanelVisibleToggled","reducer","actions","mapPanelsInfoSelector","createSelector","UI","isControlPanelVisibleSelector","oauthInfo","esriId","userPortal","WEB_MAP_ID_HYBRID","credential","initEsriOAuth","appId","portalUrl","loadModules","OAuthInfo","identityManager","Portal","popup","registerOAuthInfos","checkSignInStatus","url","authMode","load","portal","signIn","getCredential","signOut","token","axios","method","params","client_id","destroyCredentials","window","location","reload","getUserData","user","fullName","id","username","group","image","thumbnailUrl","favGroupId","switchAccount","portalBaseUrl","urlKey","customBaseUrl","getPortalBaseUrl","redirectUri","origin","pathname","targetUrl","open","initialMapState","indexOfActiveMapPanel","center","lat","lon","zoom","zoomLevels","relativeZoomLevels","scales","extents","webmapId","isLoadingWebmap","webmapRequestError","webmapIdChanged","isInvalidWebmapId","invalidWebmapIdChanged","mapCenterChanged","extentsChanged","zoomLevelsChanged","scalesChanged","relativeZoomLevelsChanged","indexOfActiveMapPanelChanged","webmapRequestErrorReceived","updateWebmapId","dispatch","getState","getItem","authentication","UserSession","type","setInvalidWebmapIdToTrue","requestError","code","message","setWebmapRequestError","setTimeout","error","webmapIdSelector","Map","MapCenterSelector","extentsSelector","zoomLevelsSelector","scalesSelector","relativeZoomLevelsSelector","indexOfActiveMapPanelSelector","isInvalidWebmapIdSelector","webmapRequestErrorSelector","combineReducers","getPreloadedUIState","layout","split","getPreloadedMapState","map","d","preloadedState","store","configureStore","rootReducer","middleware","getDefaultMiddleware","AppContext","createContext","children","useState","darkMode","init","React","Provider","EsriOAuthContext","setValue","userData","signedIn","useEffect","useDispatch","useSelector","className","style","boxShadow","onClick","xmlns","viewBox","height","width","PanelIcon","panelInfo","isSelected","classNames","classnames","rects","i","push","margin","getRect","PanelIconsData","WEB_MAPS","title","thumbnail","hybrid_thumbnail","imagery_thumbnail","human_geo_light_thumbnail","human_dark_light_thumbnail","topo_thumbnail","vibrant_thumbnail","WebMapOption","data","isActive","bind","background","backgroundRepeat","backgroundSize","WebMapIdTextInput","val","setVal","useContext","placeholder","onChange","event","target","itemId","indexOf","search","param","decodeQueryString","webmap","getItemId","fill","onChangeHandler","activeWebmapId","groups","forEach","index","groupIdx","Math","floor","elements","idx","ref","handler","listener","targetElement","current","contains","document","addEventListener","removeEventListener","getBtnLabel","Title","CloseBtn","containerRef","useRef","useOnClickOutside","loadCss","isActiveMapPanel","shouldHideAttribution","centerOnChange","zoomOnChange","extentOnChange","scaleOnChange","mapDivRef","isActiveMapRef","shouldTriggerExtentOnChangeRef","mapContainerSizeRef","mapView","setMapView","initMapView","MapView","WebMap","Zoom","view","container","portalItem","navigation","mouseWheelZoomEnabled","browserTouchPanEnabled","constraints","rotationEnabled","ui","components","color","zoomWidget","add","when","updateWebmap","canZoomRef","addMouseWheelEvent","on","mapViewNavigation","deltaY","scaleFactor","promise","then","end","addWatchEvent","watchUtils","watch","longitude","latitude","whenTrue","extent","toFixed","containerSize","scale","goTo","duration","position","top","left","bottom","right","child","indexOfTargetMap","indexOfContainerMap","extentOfTargetMapRef","prevZoomRef","pos","setPos","calcPos","extentString","JSON","parse","xmin","ymin","xmax","ymax","spatialReference","Point","pointMin","x","y","pointMax","screenPointMin","toScreen","screenPointMax","abs","ext1","ext2","diffX1","diffY1","diffX2","diffY2","display","isActivePanel","newZoom","mapPanelIndex","targetVal","adjustedRelativeZoomLevels","newZoomeLevels","currZoom","join","updateZoomLevels","newExtents","stringify","toJSON","updateExtents","newScales","updateScale","extentBoxes","getExtentBoxes","LockedIcon","UnlockedIcon","placeOnLeftSide","isUnlocked","SIZE","justifyContent","alignItems","borderRadius","textShadow","numberFns","isHorizontal","idxOfActiveMapPanel","panels","shouldShowZoomLock","shouldShowBorder","onMouseEnter","shouldUnlock","newRelativeZoomLevels","getPanels","getPreloadedState","ReactDOM","configureAppStore","getElementById","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","call","m","O","result","chunkIds","fn","priority","notFulfilled","Infinity","length","fulfilled","j","Object","keys","every","splice","n","getter","__esModule","a","definition","o","defineProperty","enumerable","get","g","globalThis","this","Function","e","obj","prop","prototype","hasOwnProperty","scriptUrl","importScripts","currentScript","src","scripts","getElementsByTagName","Error","replace","p","installedChunks","179","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","__webpack_exports__"],"mappings":"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","file":"main.071f34ee5f8b084c91bd.js","sourcesContent":["var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tresult = fn();\n\t\t}\n\t}\n\treturn result;\n};","import { urlFns } from 'helper-toolkit-ts';\r\n\r\ntype UrlHashParamKey = 'center' | 'zoom' | 'layout' | 'webmapId';\r\n\r\ntype HashParams = Record<UrlHashParamKey, string>;\r\n\r\nexport const DEFAULT_HASH_PARAMS: HashParams = urlFns.parseHash();\r\n\r\nexport const setHashParam = (key: UrlHashParamKey, value: string) => {\r\n    urlFns.updateHashParam({\r\n        key,\r\n        value,\r\n    });\r\n};\r\n","import {\r\n    createSlice,\r\n    createSelector,\r\n    PayloadAction,\r\n    // createAsyncThunk\r\n} from '@reduxjs/toolkit';\r\nimport { setHashParam } from '../../utils/URLHashParams';\r\n\r\nimport { RootState, StoreDispatch, StoreGetState } from '../configureStore';\r\n\r\nexport type MapPanelsDirection = 'horizontal' | 'vertical';\r\n\r\nexport type MapPanelsInfo = {\r\n    direction?: MapPanelsDirection;\r\n    num?: number;\r\n};\r\n\r\nexport type UIState = {\r\n    mapPanelsInfo?: MapPanelsInfo;\r\n    isControlPanelVisible?: boolean;\r\n};\r\n\r\nexport const initialUIState: UIState = {\r\n    mapPanelsInfo: {\r\n        direction: 'horizontal',\r\n        num: 3,\r\n    },\r\n    isControlPanelVisible: false,\r\n};\r\n\r\nconst slice = createSlice({\r\n    name: 'UI',\r\n    initialState: initialUIState,\r\n    reducers: {\r\n        mapPanelsInfoChanged: (state, action: PayloadAction<MapPanelsInfo>) => {\r\n            state.mapPanelsInfo = action.payload;\r\n        },\r\n        isControlPanelVisibleToggled: (state) => {\r\n            state.isControlPanelVisible = !state.isControlPanelVisible;\r\n        },\r\n    },\r\n});\r\n\r\nconst { reducer } = slice;\r\n\r\nexport const {\r\n    mapPanelsInfoChanged,\r\n    isControlPanelVisibleToggled,\r\n} = slice.actions;\r\n\r\nexport const updatePanelsLayout = (layout: MapPanelsInfo) => (\r\n    dispatch: StoreDispatch,\r\n    getState: StoreGetState\r\n) => {\r\n    const { direction, num } = layout;\r\n    setHashParam('layout', `${direction},${num}`);\r\n    dispatch(mapPanelsInfoChanged(layout));\r\n};\r\n\r\nexport const mapPanelsInfoSelector = createSelector(\r\n    (state: RootState) => state.UI.mapPanelsInfo,\r\n    (mapPanelsInfo) => mapPanelsInfo\r\n);\r\n\r\nexport const isControlPanelVisibleSelector = createSelector(\r\n    (state: RootState) => state.UI.isControlPanelVisible,\r\n    (isControlPanelVisible) => isControlPanelVisible\r\n);\r\n\r\nexport default reducer;\r\n","// topo webmap\r\n// export const WEB_MAP_ID = '5f3b7605b3364e7bb2416c93fae00995';\r\n\r\n// // imagery webmap\r\nexport const WEB_MAP_ID = 'd507d08f4959438687caf2914854d8d4';\r\n\r\nexport const WEB_MAP_ID_IMAGERY = '5226eb89ecb94252aee274671241c8d1';\r\nexport const WEB_MAP_ID_HYBRID = 'd507d08f4959438687caf2914854d8d4';\r\nexport const WEB_MAP_ID_HUMAN_GEO_LIGHT = '3582b744bba84668b52a16b0b6942544';\r\nexport const WEB_MAP_ID_HUMAN_GEO_DARK = '4f2e99ba65e34bb8af49733d9778fb8e';\r\nexport const WEB_MAP_ID_TOPO = '5f3b7605b3364e7bb2416c93fae00995';\r\nexport const WEB_MAP_ID_VIBRANT = 'd27a3805595e4bb598678f2dc3b1fca3';\r\n\r\n// App ID from the AGOL Item: https://arcgis-content.maps.arcgis.com/home/item.html?id=045586e2250c4a5fb05b4f78c933dc63#settings\r\nexport const APP_ID = 'XZ72FRZGq9MKlofJ';\r\n","import { loadModules } from 'esri-loader';\r\nimport axios from 'axios';\r\n\r\nimport IOAuthInfo from 'esri/identity/OAuthInfo';\r\nimport IdentityManager from 'esri/identity/IdentityManager';\r\nimport IPortal from 'esri/portal/Portal';\r\nimport ICredential from 'esri/identity/Credential';\r\nimport IPortalUser from 'esri/portal/PortalUser';\r\nimport { UserSession } from '@esri/arcgis-rest-auth';\r\n\r\ntype Props = {\r\n    appId: string;\r\n    portalUrl?: string;\r\n};\r\n\r\ntype OAuthResponse = {\r\n    credential: ICredential;\r\n    portal: IPortal;\r\n};\r\n\r\ntype IPlatformSelfResponse = {\r\n    expires_in: number;\r\n    token: string;\r\n    username: string;\r\n};\r\n\r\nexport type UserData = {\r\n    name: string;\r\n    id: string;\r\n    group: string;\r\n    image: string;\r\n    favGroupId: string;\r\n};\r\n\r\nlet oauthInfo: IOAuthInfo;\r\nlet esriId: typeof IdentityManager;\r\nlet userPortal: IPortal;\r\nlet credential: ICredential = null;\r\n\r\n// const platformSelf = async(appId:string, portalUrl='https://www.arcgis.com'):Promise<IPlatformSelfResponse>=>{\r\n//     // The primary purpose of the esri_auth platform cookie (clear-text platform cookie bound to .arcgis.com) was for the ArcGIS Online backend to maintain single sign-on state for the signed in user.\r\n//     // Since it was in clear text, various apps (including the Home app) were reading and writing to this platform cookie either for accomplishing workflows which otherwise were not possible due to unavailable additional rest api calls or out of convenience.\r\n//     // This esri_auth cookie got flagged by multiple security scanners as a vulnerability since it is set in clear text, contains a token and is accessible via JavaScript which could exploited in a XSS attack.\r\n//     // Therefore, ArcGIS Online team has decided to move away from using clear text \"esri_auth\" platform cookie,\r\n//     // Moving forward, we should call oauth2/platformSelf along with encrypted platform cookie to check if the user has access to the app before returning the username and the app-specific token for that user.\r\n//     // For more information: https://confluencewikidev.esri.com/display/AGO/Moving+Away+From+Clear-Text+esri_auth+Platform+Cookie\r\n//     const { data } = await axios({\r\n//         url: portalUrl + '/sharing/rest/oauth2/platformSelf?f=json',\r\n//         method: 'post',\r\n//         headers: {\r\n//             'X-Esri-Auth-Client-Id': appId,\r\n//             'X-Esri-Auth-Redirect-Uri': window.location.origin\r\n//         },\r\n//         withCredentials: true\r\n//     });\r\n\r\n//     if(data.error){\r\n//         return null;\r\n//     }\r\n\r\n//     const {\r\n//         expires_in,\r\n//         token,\r\n//         username\r\n//     } = data;\r\n\r\n//     return {\r\n//         expires_in,\r\n//         token,\r\n//         username\r\n//     }\r\n// }\r\n\r\nexport const initEsriOAuth = async ({\r\n    appId,\r\n    portalUrl = 'https://www.arcgis.com',\r\n}: Props): Promise<OAuthResponse> => {\r\n    try {\r\n        type Modules = [\r\n            typeof IOAuthInfo,\r\n            typeof IdentityManager,\r\n            typeof IPortal\r\n        ];\r\n\r\n        const [OAuthInfo, identityManager, Portal] = await (loadModules([\r\n            'esri/identity/OAuthInfo',\r\n            'esri/identity/IdentityManager',\r\n            'esri/portal/Portal',\r\n        ]) as Promise<Modules>);\r\n\r\n        // const platformSelfResponse = await platformSelf(appId, portalUrl)\r\n\r\n        oauthInfo = new OAuthInfo({\r\n            appId,\r\n            portalUrl,\r\n            popup: false,\r\n        });\r\n\r\n        esriId = identityManager;\r\n\r\n        esriId.registerOAuthInfos([oauthInfo]);\r\n\r\n        // if(platformSelfResponse){\r\n\r\n        //     const {\r\n        //         expires_in,\r\n        //         token,\r\n        //         username\r\n        //     } = platformSelfResponse;\r\n\r\n        //     esriId.registerToken({\r\n        //         expires: expires_in,\r\n        //         token: token,\r\n        //         server: portalUrl,\r\n        //         userId: username,\r\n        //         ssl: false\r\n        //     });\r\n        // }\r\n\r\n        credential = await esriId.checkSignInStatus(\r\n            oauthInfo.portalUrl + '/sharing'\r\n        );\r\n\r\n        // init paortal\r\n        userPortal = new Portal({ url: portalUrl });\r\n        // Setting authMode to immediate signs the user in once loaded\r\n        userPortal.authMode = 'immediate';\r\n\r\n        // Once loaded, user is signed in\r\n        await userPortal.load();\r\n    } catch (err) {\r\n        console.log('anomynous user');\r\n    }\r\n\r\n    return {\r\n        credential,\r\n        portal: userPortal,\r\n    };\r\n};\r\n\r\nexport const signIn = async (): Promise<void> => {\r\n    const credential: ICredential = await esriId.getCredential(\r\n        oauthInfo.portalUrl + '/sharing'\r\n    );\r\n    console.log('signed in as', credential.userId);\r\n};\r\n\r\nexport const signOut = async (): Promise<void> => {\r\n    const { appId, portalUrl } = oauthInfo;\r\n    const { token } = credential;\r\n\r\n    try {\r\n        // need to call oauth2/signout to clear the encrypted cookie and signs the user out of the ArcGIS platform\r\n        // here to learn more: https://confluencewikidev.esri.com/display/AGO/oAuth+signout\r\n        await axios({\r\n            url: portalUrl + '/sharing/rest/oauth2/signout',\r\n            method: 'post',\r\n            params: {\r\n                client_id: appId,\r\n                token,\r\n                // redirect_uri: window.location.href\r\n            },\r\n        });\r\n    } catch (err) {\r\n        console.error(err);\r\n    }\r\n\r\n    esriId.destroyCredentials();\r\n\r\n    window.location.reload();\r\n};\r\n\r\n// get the user data object to populate Esri Global Nav\r\nexport const getUserData = (): UserData => {\r\n    if (!userPortal) {\r\n        return null;\r\n    }\r\n\r\n    const { name } = userPortal;\r\n\r\n    const user: IPortalUser & {\r\n        favGroupId?: string;\r\n    } = userPortal.user;\r\n\r\n    const { fullName, username, thumbnailUrl, favGroupId } = user;\r\n\r\n    return {\r\n        // \tname: 'Cassidy Bishop',\r\n        name: fullName,\r\n        // \tid: 'iamoktatester@gmail.com',\r\n        id: username,\r\n        // \tgroup: 'Riverside City Mgmt.',\r\n        group: name,\r\n        // \timage: '//placehold.it/300x300'\r\n        image: thumbnailUrl,\r\n        favGroupId,\r\n    };\r\n};\r\n\r\nconst getPortalBaseUrl = () => {\r\n    if (!userPortal) {\r\n        return null;\r\n    }\r\n\r\n    const { urlKey, url, customBaseUrl } = userPortal;\r\n\r\n    return urlKey ? `https://${urlKey}.${customBaseUrl}` : `${url}`;\r\n};\r\n\r\nexport const switchAccount = () => {\r\n    const portalBaseUrl = getPortalBaseUrl();\r\n    const redirectUri = `${window.location.origin}${window.location.pathname}index.html`;\r\n    const targetUrl = `${portalBaseUrl}/home/pages/Account/manage_accounts.html#redirect_uri=${redirectUri}&client_id=arcgisonline`;\r\n    window.open(targetUrl, '_blank');\r\n};\r\n\r\nexport const getUserSession = (): UserSession => {\r\n    if (!credential) {\r\n        return null;\r\n    }\r\n\r\n    return UserSession.fromCredential(credential);\r\n};\r\n","import {\r\n    createSlice,\r\n    createSelector,\r\n    PayloadAction,\r\n    // createAsyncThunk\r\n} from '@reduxjs/toolkit';\r\nimport { WEB_MAP_ID_HYBRID } from '../../constants/map';\r\n\r\nimport { RootState, StoreDispatch, StoreGetState } from '../configureStore';\r\n\r\nimport IExtent from 'esri/geometry/Extent';\r\n\r\nimport { getItem } from '@esri/arcgis-rest-portal';\r\nimport { setHashParam } from '../../utils/URLHashParams';\r\nimport { getUserSession } from '../../utils/esri-oauth';\r\n\r\nexport type MapCenter = {\r\n    lat?: number;\r\n    lon?: number;\r\n};\r\n\r\nexport type RequestError = {\r\n    code?: string;\r\n    message?: string;\r\n};\r\n\r\nexport type MapState = {\r\n    indexOfActiveMapPanel?: number;\r\n    center?: MapCenter;\r\n    zoom?: number;\r\n    zoomLevels?: number[];\r\n    relativeZoomLevels?: number[];\r\n    scales?: number[];\r\n    // extents JSON of each map panel as an array of strings\r\n    extents?: string[];\r\n    webmapId?: string;\r\n    isLoadingWebmap?: boolean;\r\n    isInvalidWebmapId?: boolean;\r\n    webmapRequestError?: RequestError;\r\n};\r\n\r\nexport const initialMapState: MapState = {\r\n    indexOfActiveMapPanel: -1,\r\n    center: {\r\n        lat: 34.05624,\r\n        lon: -117.1957,\r\n    },\r\n    zoom: 10,\r\n    zoomLevels: [10, 12, 14],\r\n    relativeZoomLevels: [-2, 0, 2],\r\n    scales: [0, 0, 0],\r\n    extents: [],\r\n    webmapId: WEB_MAP_ID_HYBRID,\r\n    isLoadingWebmap: false,\r\n    webmapRequestError: null,\r\n};\r\n\r\nconst slice = createSlice({\r\n    name: 'Map',\r\n    initialState: initialMapState,\r\n    reducers: {\r\n        webmapIdChanged: (state, action: PayloadAction<string>) => {\r\n            state.webmapId = action.payload;\r\n            state.isInvalidWebmapId = false;\r\n        },\r\n        invalidWebmapIdChanged: (state, action: PayloadAction<boolean>) => {\r\n            state.isInvalidWebmapId = action.payload;\r\n        },\r\n        mapCenterChanged: (state, action: PayloadAction<MapCenter>) => {\r\n            state.center = action.payload;\r\n        },\r\n        extentsChanged: (state, action: PayloadAction<string[]>) => {\r\n            state.extents = action.payload;\r\n        },\r\n        zoomLevelsChanged: (state, action: PayloadAction<number[]>) => {\r\n            state.zoomLevels = action.payload;\r\n        },\r\n        scalesChanged: (state, action: PayloadAction<number[]>) => {\r\n            state.scales = action.payload;\r\n        },\r\n        relativeZoomLevelsChanged: (state, action: PayloadAction<number[]>) => {\r\n            state.relativeZoomLevels = action.payload;\r\n        },\r\n        indexOfActiveMapPanelChanged: (\r\n            state,\r\n            action: PayloadAction<number>\r\n        ) => {\r\n            state.indexOfActiveMapPanel = action.payload;\r\n        },\r\n        webmapRequestErrorReceived: (\r\n            state,\r\n            action: PayloadAction<RequestError>\r\n        ) => {\r\n            state.webmapRequestError = action.payload;\r\n        },\r\n    },\r\n});\r\n\r\nconst { reducer } = slice;\r\n\r\nexport const {\r\n    webmapIdChanged,\r\n    mapCenterChanged,\r\n    zoomLevelsChanged,\r\n    relativeZoomLevelsChanged,\r\n    indexOfActiveMapPanelChanged,\r\n    extentsChanged,\r\n    invalidWebmapIdChanged,\r\n    scalesChanged,\r\n    webmapRequestErrorReceived,\r\n} = slice.actions;\r\n\r\nexport const toggleLockRelativeZoomLevels = (mapPanelIndex: number) => (\r\n    dispatch: StoreDispatch,\r\n    getState: StoreGetState\r\n) => {\r\n    const { Map } = getState();\r\n    const { zoomLevels, relativeZoomLevels } = Map;\r\n\r\n    const shouldUnlock =\r\n        relativeZoomLevels[mapPanelIndex] !== null &&\r\n        relativeZoomLevels[mapPanelIndex + 1] !== null;\r\n\r\n    const newRelativeZoomLevels = [...relativeZoomLevels];\r\n\r\n    if (mapPanelIndex === 0) {\r\n        newRelativeZoomLevels[0] = shouldUnlock\r\n            ? null\r\n            : zoomLevels[0] - zoomLevels[1];\r\n    } else if (mapPanelIndex === 1) {\r\n        newRelativeZoomLevels[2] = shouldUnlock\r\n            ? null\r\n            : zoomLevels[2] - zoomLevels[1];\r\n    }\r\n\r\n    dispatch(relativeZoomLevelsChanged(newRelativeZoomLevels));\r\n};\r\n\r\nexport const updateZoomLevels = (zoom: number, mapPanelIndex: number) => (\r\n    dispatch: StoreDispatch,\r\n    getState: StoreGetState\r\n) => {\r\n    const { Map } = getState();\r\n    const { zoomLevels, relativeZoomLevels } = Map;\r\n\r\n    if (zoomLevels[mapPanelIndex] === zoom) {\r\n        return;\r\n    }\r\n\r\n    // lock && lock: [-2, 0, 2]\r\n    // unlock && lock: [null, 0, 2]\r\n    // lock && unlock: [-2, 0, null]\r\n    // unlock && unlock: [null, 0, null]\r\n\r\n    const targetVal = relativeZoomLevels[mapPanelIndex];\r\n\r\n    const adjustedRelativeZoomLevels = relativeZoomLevels.map((val) => {\r\n        if (val === null || targetVal === null) {\r\n            return null;\r\n        }\r\n\r\n        return val - targetVal;\r\n    });\r\n\r\n    // console.log(adjustedRelativeZoomLevels)\r\n\r\n    const newZoomeLevels = zoomLevels.map((currZoom, i) => {\r\n        if (mapPanelIndex === i) {\r\n            return zoom;\r\n        }\r\n\r\n        if (adjustedRelativeZoomLevels[i] === null) {\r\n            return currZoom;\r\n        }\r\n\r\n        return zoom + adjustedRelativeZoomLevels[i];\r\n    });\r\n\r\n    // console.log(newZoomeLevels)\r\n\r\n    // console.log(zoomLevels, newZoomeLevels);\r\n\r\n    dispatch(zoomLevelsChanged(newZoomeLevels));\r\n\r\n    setHashParam('zoom', newZoomeLevels.join(','));\r\n};\r\n\r\nexport const updateExtents = (extent: IExtent, mapPanelIndex: number) => (\r\n    dispatch: StoreDispatch,\r\n    getState: StoreGetState\r\n) => {\r\n    const { Map } = getState();\r\n    const { extents } = Map;\r\n\r\n    const newExtents = [...extents];\r\n\r\n    newExtents[mapPanelIndex] = JSON.stringify(extent.toJSON());\r\n\r\n    dispatch(extentsChanged(newExtents));\r\n};\r\n\r\nexport const updateScale = (scale: number, mapPanelIndex: number) => (\r\n    dispatch: StoreDispatch,\r\n    getState: StoreGetState\r\n) => {\r\n    const { Map } = getState();\r\n    const { scales } = Map;\r\n\r\n    const newScales = [...scales];\r\n\r\n    newScales[mapPanelIndex] = scale;\r\n\r\n    dispatch(scalesChanged(newScales));\r\n};\r\n\r\nexport const updateWebmapId = (id: string) => async (\r\n    dispatch: StoreDispatch,\r\n    getState: StoreGetState\r\n) => {\r\n    try {\r\n        const itemData = await getItem(id, {\r\n            authentication: getUserSession(),\r\n        });\r\n\r\n        if (itemData.type !== 'Web Map') {\r\n            dispatch(setInvalidWebmapIdToTrue());\r\n        } else {\r\n            dispatch(webmapIdChanged(id));\r\n            setHashParam('webmapId', id);\r\n        }\r\n    } catch (err) {\r\n        console.log(err);\r\n        const requestError: RequestError = {\r\n            code: err.code || '',\r\n            message: err.message || '',\r\n        };\r\n        dispatch(setWebmapRequestError(requestError));\r\n    }\r\n};\r\n\r\nconst setInvalidWebmapIdToTrue = () => async (\r\n    dispatch: StoreDispatch,\r\n    getState: StoreGetState\r\n) => {\r\n    dispatch(invalidWebmapIdChanged(true));\r\n\r\n    setTimeout(() => {\r\n        dispatch(invalidWebmapIdChanged(false));\r\n    }, 5000);\r\n};\r\n\r\nconst setWebmapRequestError = (error: RequestError) => async (\r\n    dispatch: StoreDispatch,\r\n    getState: StoreGetState\r\n) => {\r\n    dispatch(webmapRequestErrorReceived(error));\r\n\r\n    setTimeout(() => {\r\n        dispatch(webmapRequestErrorReceived(null));\r\n    }, 5000);\r\n};\r\n\r\nexport const webmapIdSelector = createSelector(\r\n    (state: RootState) => state.Map.webmapId,\r\n    (webmapId) => webmapId\r\n);\r\n\r\nexport const MapCenterSelector = createSelector(\r\n    (state: RootState) => state.Map.center,\r\n    (center) => center\r\n);\r\n\r\nexport const extentsSelector = createSelector(\r\n    (state: RootState) => state.Map.extents,\r\n    (extents) => extents\r\n);\r\n\r\nexport const zoomLevelsSelector = createSelector(\r\n    (state: RootState) => state.Map.zoomLevels,\r\n    (zoomLevels) => zoomLevels\r\n);\r\n\r\nexport const scalesSelector = createSelector(\r\n    (state: RootState) => state.Map.scales,\r\n    (scales) => scales\r\n);\r\n\r\nexport const relativeZoomLevelsSelector = createSelector(\r\n    (state: RootState) => state.Map.relativeZoomLevels,\r\n    (relativeZoomLevels) => relativeZoomLevels\r\n);\r\n\r\nexport const indexOfActiveMapPanelSelector = createSelector(\r\n    (state: RootState) => state.Map.indexOfActiveMapPanel,\r\n    (indexOfActiveMapPanel) => indexOfActiveMapPanel\r\n);\r\n\r\nexport const isInvalidWebmapIdSelector = createSelector(\r\n    (state: RootState) => state.Map.isInvalidWebmapId,\r\n    (isInvalidWebmapId) => isInvalidWebmapId\r\n);\r\n\r\nexport const webmapRequestErrorSelector = createSelector(\r\n    (state: RootState) => state.Map.webmapRequestError,\r\n    (webmapRequestError) => webmapRequestError\r\n);\r\n\r\nexport default reducer;\r\n","import { combineReducers } from 'redux';\r\nimport UI from './UI';\r\nimport Map from './Map';\r\n\r\nexport default combineReducers({\r\n    UI,\r\n    Map,\r\n});\r\n","import { PartialRootState } from './configureStore';\r\n\r\nimport {\r\n    initialUIState,\r\n    MapPanelsDirection,\r\n    UIState,\r\n} from '../store/reducers/UI';\r\nimport { initialMapState, MapState } from './reducers/Map';\r\n\r\nimport { DEFAULT_HASH_PARAMS } from '../utils/URLHashParams';\r\n\r\nconst getPreloadedUIState = (): UIState => {\r\n    const { layout } = DEFAULT_HASH_PARAMS;\r\n\r\n    const state: UIState = {\r\n        ...initialUIState,\r\n    };\r\n\r\n    if (layout) {\r\n        const [direction, num] = layout.split(',');\r\n\r\n        state.mapPanelsInfo = {\r\n            direction: direction as MapPanelsDirection,\r\n            num: +num,\r\n        };\r\n    }\r\n\r\n    return state;\r\n};\r\n\r\nconst getPreloadedMapState = (): MapState => {\r\n    const { zoom, webmapId, center } = DEFAULT_HASH_PARAMS;\r\n\r\n    const state: MapState = {\r\n        ...initialMapState,\r\n    };\r\n\r\n    if (webmapId) {\r\n        state.webmapId = webmapId;\r\n    }\r\n\r\n    if (center) {\r\n        const [lon, lat] = center.split(',').map((d) => +d);\r\n\r\n        state.center = {\r\n            lon,\r\n            lat,\r\n        };\r\n    }\r\n\r\n    if (zoom) {\r\n        const zoomLevels = zoom.split(',').map((d) => +d);\r\n        const relativeZoomLevels: number[] = [\r\n            zoomLevels[0] - zoomLevels[1],\r\n            0,\r\n            zoomLevels[2] - zoomLevels[1],\r\n        ];\r\n        state.zoomLevels = zoomLevels;\r\n        state.relativeZoomLevels = relativeZoomLevels;\r\n    }\r\n\r\n    return state;\r\n};\r\n\r\nconst getPreloadedState = (): PartialRootState => {\r\n    return {\r\n        UI: getPreloadedUIState(),\r\n        Map: getPreloadedMapState(),\r\n    };\r\n};\r\n\r\nexport default getPreloadedState;\r\n","import {\r\n    configureStore,\r\n    getDefaultMiddleware,\r\n    DeepPartial,\r\n} from '@reduxjs/toolkit';\r\n\r\nimport rootReducer from './reducers/rootReducer';\r\n\r\nimport getPreloadedState from './getPreloadedState';\r\n\r\nexport type RootState = ReturnType<typeof rootReducer>;\r\n\r\nexport type PartialRootState = DeepPartial<RootState>;\r\n\r\nconst configureAppStore = (preloadedState: PartialRootState = {}) => {\r\n    const store = configureStore({\r\n        reducer: rootReducer,\r\n        middleware: [...getDefaultMiddleware<RootState>()],\r\n        preloadedState,\r\n    });\r\n\r\n    return store;\r\n};\r\n\r\nexport type StoreDispatch = ReturnType<typeof configureAppStore>['dispatch'];\r\n\r\nexport type StoreGetState = ReturnType<typeof configureAppStore>['getState'];\r\n\r\nexport { getPreloadedState };\r\n\r\nexport default configureAppStore;\r\n","import React, { useState, createContext } from 'react';\r\n\r\ntype AppContextValue = {\r\n    darkMode: boolean;\r\n};\r\n\r\ntype AppContextProviderProps = {\r\n    children?: React.ReactNode;\r\n};\r\n\r\nexport const AppContext = createContext<AppContextValue>(null);\r\n\r\nconst AppContextProvider: React.FC<AppContextProviderProps> = ({\r\n    children,\r\n}: AppContextProviderProps) => {\r\n    const [value, setValue] = useState<AppContextValue>({\r\n        darkMode: false,\r\n    });\r\n\r\n    const init = async () => {\r\n        // const contextValue: AppContextValue = {\r\n        //     darkMode: false\r\n        // };\r\n        // setValue(contextValue);\r\n    };\r\n\r\n    React.useEffect(() => {\r\n        init();\r\n    }, []);\r\n\r\n    return (\r\n        <AppContext.Provider value={value}>\r\n            {value ? children : null}\r\n        </AppContext.Provider>\r\n    );\r\n};\r\n\r\nexport default AppContextProvider;\r\n","import React, { useState, createContext, useEffect } from 'react';\r\n\r\nimport IPortal from 'esri/portal/Portal';\r\nimport ICredential from 'esri/identity/Credential';\r\n\r\nimport {\r\n    initEsriOAuth,\r\n    signIn,\r\n    signOut,\r\n    getUserData,\r\n    UserData,\r\n    switchAccount,\r\n} from '../utils/esri-oauth';\r\n\r\ntype EsriOAuthContextValue = {\r\n    signedIn: boolean;\r\n    credential: ICredential;\r\n    portal: IPortal;\r\n    userData: UserData;\r\n    signIn: () => void;\r\n    signOut: () => void;\r\n    switchAccount: () => void;\r\n};\r\n\r\ntype EsriOAuthProviderProps = {\r\n    appId: string;\r\n    portalUrl?: string;\r\n    children?: React.ReactNode;\r\n};\r\n\r\nexport const EsriOAuthContext = createContext<EsriOAuthContextValue>(null);\r\n\r\nconst EsriOAuthProvider: React.FC<EsriOAuthProviderProps> = ({\r\n    appId,\r\n    portalUrl,\r\n    children,\r\n}: EsriOAuthProviderProps) => {\r\n    const [value, setValue] = useState<EsriOAuthContextValue>(null);\r\n\r\n    const init = async () => {\r\n        try {\r\n            const { credential, portal } = await initEsriOAuth({\r\n                appId,\r\n                portalUrl,\r\n            });\r\n\r\n            const userData = portal ? getUserData() : null;\r\n\r\n            setValue({\r\n                signedIn: portal !== null,\r\n                credential,\r\n                portal,\r\n                userData,\r\n                signIn,\r\n                signOut,\r\n                switchAccount,\r\n            });\r\n        } catch (err) {\r\n            console.error(err);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        init();\r\n    }, []);\r\n\r\n    return (\r\n        <EsriOAuthContext.Provider value={value}>\r\n            {value ? children : null}\r\n        </EsriOAuthContext.Provider>\r\n    );\r\n};\r\n\r\nexport default EsriOAuthProvider;\r\n","import React from 'react';\r\n\r\nimport { MapPanels, ControlPanel, ControlPanelToggleBtn } from '../';\r\n\r\nconst AppLayout = () => {\r\n    return (\r\n        <>\r\n            <MapPanels />\r\n            <ControlPanel />\r\n            <ControlPanelToggleBtn />\r\n        </>\r\n    );\r\n};\r\n\r\nexport default AppLayout;\r\n","import React from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport {\r\n    isControlPanelVisibleSelector,\r\n    isControlPanelVisibleToggled,\r\n} from '../../store/reducers/UI';\r\n\r\nconst ToggleBtn = () => {\r\n    const dispatch = useDispatch();\r\n\r\n    const isVisible = useSelector(isControlPanelVisibleSelector);\r\n\r\n    const onClickHandler = () => {\r\n        dispatch(isControlPanelVisibleToggled());\r\n        // console.log('foo')\r\n    };\r\n\r\n    if (isVisible) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <>\r\n            {/* <div\r\n                className=\"absolute\"\r\n                style={{\r\n                    height: 100,\r\n                    width: 100,\r\n                    top: -50,\r\n                    left: -50,\r\n                    background: 'radial-gradient(circle, rgba(0,0,0,9) 0%, rgba(0,0,0,.1) 75%,  rgba(0,0,0,0) 100%)'\r\n                }}\r\n            >\r\n            </div> */}\r\n\r\n            <div\r\n                className=\"absolute top-2 left-2 p-1 z-10 bg-black bg-opacity-75 hover:bg-opacity-90 text-white cursor-pointer\"\r\n                style={{\r\n                    boxShadow: '0 0 1px 1px rgba(0,0,0,.95)',\r\n                }}\r\n                onClick={onClickHandler}\r\n            >\r\n                <svg\r\n                    xmlns=\"http://www.w3.org/2000/svg\"\r\n                    className=\"fill-current\"\r\n                    viewBox=\"0 0 24 24\"\r\n                    height=\"24\"\r\n                    width=\"24\"\r\n                >\r\n                    <path d=\"M3 5h18v1H3zm0 8h18v-1H3zm0 7h18v-1H3z\" />\r\n                </svg>\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default ToggleBtn;\r\n","import React, { FC } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport {\r\n    MapPanelsDirection,\r\n    mapPanelsInfoChanged,\r\n    mapPanelsInfoSelector,\r\n    updatePanelsLayout,\r\n} from '../../store/reducers/UI';\r\nimport classnames from 'classnames';\r\n\r\ntype PanelIconProps = {\r\n    direction: MapPanelsDirection;\r\n    num: number;\r\n};\r\n\r\nconst PanelIcon: FC<PanelIconProps> = ({ direction, num }: PanelIconProps) => {\r\n    const dispatch = useDispatch();\r\n\r\n    const panelInfo = useSelector(mapPanelsInfoSelector);\r\n\r\n    const isSelected =\r\n        panelInfo.direction === direction && panelInfo.num === num;\r\n\r\n    const onClickHandler = () => {\r\n        dispatch(updatePanelsLayout({ direction, num }));\r\n    };\r\n\r\n    const getRect = () => {\r\n        const rects: JSX.Element[] = [];\r\n\r\n        for (let i = 0; i < num; i++) {\r\n            rects.push(\r\n                <div\r\n                    className={classnames('flex-grow', {\r\n                        'bg-gray-50': !isSelected,\r\n                        'bg-white': isSelected,\r\n                    })}\r\n                    style={{\r\n                        margin: 1,\r\n                    }}\r\n                    key={`${direction}-${num}-${i}`}\r\n                ></div>\r\n            );\r\n        }\r\n\r\n        return rects;\r\n    };\r\n\r\n    const classNames = classnames('cursor-pointer mx-1 mb-2 p-1 flex border', {\r\n        'flex-col': direction === 'vertical',\r\n        'border-gray-50': !isSelected,\r\n        'opacity-50': !isSelected,\r\n        'border-white': isSelected,\r\n    });\r\n\r\n    return (\r\n        <div\r\n            className={classNames}\r\n            style={{\r\n                height: 62,\r\n                width: 100,\r\n            }}\r\n            onClick={onClickHandler}\r\n        >\r\n            {getRect()}\r\n        </div>\r\n    );\r\n};\r\n\r\nconst PanelIconsData: PanelIconProps[] = [\r\n    {\r\n        direction: 'horizontal',\r\n        num: 2,\r\n    },\r\n    {\r\n        direction: 'horizontal',\r\n        num: 3,\r\n    },\r\n    {\r\n        direction: 'vertical',\r\n        num: 2,\r\n    },\r\n    {\r\n        direction: 'vertical',\r\n        num: 3,\r\n    },\r\n];\r\n\r\nconst PanelConfiguration = () => {\r\n    return (\r\n        <div className=\"md:border-r border-white border-opacity-30 md:mr-7\">\r\n            <h5 className=\"mb-2\">Panel configuration</h5>\r\n            <div className=\"cursor-pointer flex flex-wrap w-60\">\r\n                {PanelIconsData.map(({ direction, num }) => {\r\n                    return (\r\n                        <PanelIcon\r\n                            key={`${direction}-${num}`}\r\n                            direction={direction}\r\n                            num={num}\r\n                        />\r\n                    );\r\n                })}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default PanelConfiguration;\r\n","export default __webpack_public_path__ + \"e95afdaa53cdaaa1660def75b2a6d42f.jpg\";","export default __webpack_public_path__ + \"03fd43f82b7c26bbcd5bfbe8b6df62d4.jpg\";","export default __webpack_public_path__ + \"b5dca04e5cc67a469ba7cb9ea62cc066.jpg\";","export default __webpack_public_path__ + \"926c9f9b73e2d71d120577d50283afea.jpg\";","export default __webpack_public_path__ + \"23dc91edbb045ee443069f5fad21570b.jpg\";","export default __webpack_public_path__ + \"f4e467b4f7054ffcfe4c5b11cf8290b7.png\";","import React, { FC, useContext, useEffect, useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport {\r\n    WEB_MAP_ID_HUMAN_GEO_DARK,\r\n    WEB_MAP_ID_HUMAN_GEO_LIGHT,\r\n    WEB_MAP_ID_HYBRID,\r\n    WEB_MAP_ID_IMAGERY,\r\n    WEB_MAP_ID_TOPO,\r\n    WEB_MAP_ID_VIBRANT,\r\n} from '../../constants/map';\r\nimport {\r\n    isInvalidWebmapIdSelector,\r\n    updateWebmapId,\r\n    webmapIdChanged,\r\n    webmapIdSelector,\r\n    webmapRequestErrorSelector,\r\n} from '../../store/reducers/Map';\r\n\r\nimport imagery_thumbnail from '../../static/imagery.jpg';\r\nimport hybrid_thumbnail from '../../static/hybrid.jpg';\r\nimport human_geo_light_thumbnail from '../../static/human-geo-light.jpg';\r\nimport human_dark_light_thumbnail from '../../static/human-geo-dark.jpg';\r\nimport topo_thumbnail from '../../static/topo.jpg';\r\nimport vibrant_thumbnail from '../../static/vibrant.png';\r\nimport classnames from 'classnames';\r\nimport { decodeQueryString } from '@esri/arcgis-rest-request';\r\nimport { EsriOAuthContext } from '../../contexts/EsriOAuthProvider';\r\nimport { webMercatorToGeographic } from 'esri/geometry/support/webMercatorUtils';\r\n\r\ntype WebMapInfo = {\r\n    title: string;\r\n    id: string;\r\n    thumbnail: any;\r\n};\r\n\r\nexport const WEB_MAPS: WebMapInfo[] = [\r\n    {\r\n        title: 'Imagery With Label',\r\n        id: WEB_MAP_ID_HYBRID,\r\n        thumbnail: hybrid_thumbnail,\r\n    },\r\n    {\r\n        title: 'Imagery',\r\n        id: WEB_MAP_ID_IMAGERY,\r\n        thumbnail: imagery_thumbnail,\r\n    },\r\n    {\r\n        title: 'Human Geo Light',\r\n        id: WEB_MAP_ID_HUMAN_GEO_LIGHT,\r\n        thumbnail: human_geo_light_thumbnail,\r\n    },\r\n    {\r\n        title: 'Human Geo Dark',\r\n        id: WEB_MAP_ID_HUMAN_GEO_DARK,\r\n        thumbnail: human_dark_light_thumbnail,\r\n    },\r\n    {\r\n        title: 'Terrain',\r\n        id: WEB_MAP_ID_TOPO,\r\n        thumbnail: topo_thumbnail,\r\n    },\r\n    {\r\n        title: 'Vibrant',\r\n        id: WEB_MAP_ID_VIBRANT,\r\n        thumbnail: vibrant_thumbnail,\r\n    },\r\n];\r\n\r\ntype PropsWebMapOption = {\r\n    data: WebMapInfo;\r\n    isActive: boolean;\r\n    onClick: (id: string) => void;\r\n};\r\n\r\nconst WebMapOption: FC<PropsWebMapOption> = ({\r\n    data,\r\n    isActive,\r\n    onClick,\r\n}: PropsWebMapOption) => {\r\n    const { title, id, thumbnail } = data;\r\n\r\n    return (\r\n        <div key={id} className=\"flex items-center mb-2\">\r\n            <div\r\n                className={classnames('cursor-pointer border', {\r\n                    'border-white': isActive,\r\n                    'border-gray-50': !isActive,\r\n                    'opacity-60': !isActive,\r\n                })}\r\n                onClick={onClick.bind(null, id)}\r\n                style={{\r\n                    height: 62,\r\n                    width: 62,\r\n                    background: `url(${thumbnail}) center center`,\r\n                    backgroundRepeat: 'no-repeat',\r\n                    backgroundSize: 'cover',\r\n                }}\r\n            ></div>\r\n\r\n            <div className=\"ml-3\">\r\n                <span className=\"text-sm\">{title}</span>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst getItemId = (url: string) => {\r\n    if (url.indexOf('?') === -1) {\r\n        return url;\r\n    }\r\n\r\n    const [path, search] = url.split('?');\r\n\r\n    const param = decodeQueryString(search);\r\n\r\n    return param.webmap || param.id || '';\r\n};\r\n\r\nconst WebMapIdTextInput = () => {\r\n    const dispatch = useDispatch();\r\n\r\n    const [val, setVal] = useState<string>('');\r\n\r\n    const { credential, signIn } = useContext(EsriOAuthContext);\r\n\r\n    const isInvalidWebmapId = useSelector(isInvalidWebmapIdSelector);\r\n\r\n    const webmapRequestError = useSelector(webmapRequestErrorSelector);\r\n\r\n    const getHeaderText = () => {\r\n        if (isInvalidWebmapId || webmapRequestError) {\r\n            return 'Invalid Item Id';\r\n        }\r\n\r\n        return 'Any ArcGIS Online 2D Web Map';\r\n    };\r\n\r\n    const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n        setVal(event.target.value);\r\n    };\r\n\r\n    const onClickHandler = () => {\r\n        const itemId = getItemId(val);\r\n\r\n        dispatch(updateWebmapId(itemId));\r\n    };\r\n\r\n    useEffect(() => {\r\n        // sign in if get \"You do not have permissions to access this resource\" error\r\n        if (\r\n            webmapRequestError &&\r\n            webmapRequestError.code === 'GWM_0003' &&\r\n            !credential\r\n        ) {\r\n            signIn();\r\n        }\r\n    }, [webmapRequestError]);\r\n\r\n    return (\r\n        <div className=\"pb-2\">\r\n            <h5 className=\"text-sm text-gray-200 mb-1\">{getHeaderText()}</h5>\r\n\r\n            <div className=\"flex items-stretch\">\r\n                <input\r\n                    type=\"text\"\r\n                    placeholder=\"Web Map link or Item Id\"\r\n                    className=\"bg-transparent border border-r-0 border-gray-500 p-2 placeholder-opacity-50 text-sm\"\r\n                    value={val}\r\n                    onChange={handleChange}\r\n                />\r\n\r\n                <div\r\n                    className={classnames(\r\n                        'flex justify-center items-center w-10 border border-gray-500',\r\n                        {\r\n                            'text-gray-700': val === '',\r\n                            'text-gray-200': val !== '',\r\n                            'cursor-pointer': val !== '',\r\n                            'pointer-events-none': val === '',\r\n                        }\r\n                    )}\r\n                    onClick={onClickHandler}\r\n                >\r\n                    <svg\r\n                        xmlns=\"http://www.w3.org/2000/svg\"\r\n                        className=\"fill-current\"\r\n                        viewBox=\"0 0 24 24\"\r\n                        height=\"24\"\r\n                        width=\"24\"\r\n                    >\r\n                        <path d=\"M6 1.773l15 10.23L6 22.226z\" />\r\n                        <path fill=\"none\" d=\"M0 0h24v24H0z\" />\r\n                    </svg>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst WebMapSelector = () => {\r\n    const dispatch = useDispatch();\r\n\r\n    const onChangeHandler = (id: string) => {\r\n        dispatch(updateWebmapId(id));\r\n    };\r\n\r\n    const activeWebmapId = useSelector(webmapIdSelector);\r\n\r\n    const groups: JSX.Element[][] = [];\r\n\r\n    const getOptions = () => {\r\n        WEB_MAPS.forEach((data, index) => {\r\n            const groupIdx = Math.floor(index / 2);\r\n\r\n            groups[groupIdx] = groups[groupIdx] || [];\r\n\r\n            groups[groupIdx].push(\r\n                <WebMapOption\r\n                    key={data.id}\r\n                    data={data}\r\n                    isActive={data.id === activeWebmapId}\r\n                    onClick={onChangeHandler}\r\n                />\r\n            );\r\n        });\r\n\r\n        return (\r\n            <div className=\"md:flex\">\r\n                <div className=\"flex\">\r\n                    {groups.map((elements, idx) => {\r\n                        return (\r\n                            <div key={idx} className=\"mr-4\">\r\n                                {elements}\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n\r\n                <div className=\"flex items-end mt-2 md:mt-0 md:ml-2\">\r\n                    <WebMapIdTextInput />\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div className=\"\">\r\n            <h5 className=\"mb-2\">Map</h5>\r\n            {getOptions()}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default WebMapSelector;\r\n","import React, { useEffect } from 'react';\r\n\r\nconst useOnClickOutside = (\r\n    ref: React.MutableRefObject<HTMLDivElement>,\r\n    handler: (event: MouseEvent) => void\r\n) => {\r\n    useEffect(\r\n        () => {\r\n            const listener = (event: MouseEvent) => {\r\n                const targetElement = event.target as HTMLElement;\r\n\r\n                // Do nothing if clicking ref's element or descendent elements\r\n                if (!ref.current || ref.current.contains(targetElement)) {\r\n                    return;\r\n                }\r\n\r\n                handler(event);\r\n            };\r\n\r\n            document.addEventListener('mousedown', listener);\r\n            document.addEventListener('touchstart', listener);\r\n\r\n            return () => {\r\n                document.removeEventListener('mousedown', listener);\r\n                document.removeEventListener('touchstart', listener);\r\n            };\r\n        },\r\n\r\n        // Add ref and handler to effect dependencies\r\n        // It's worth noting that because passed in handler is a new ...\r\n        // ... function on every render that will cause this effect ...\r\n        // ... callback/cleanup to run every render. It's not a big deal ...\r\n        // ... but to optimize you can wrap handler in useCallback before ...\r\n        // ... passing it into this hook.\r\n        [ref, handler]\r\n    );\r\n};\r\n\r\nexport default useOnClickOutside;\r\n","import React, { useContext } from 'react';\r\nimport { EsriOAuthContext } from '../../contexts/EsriOAuthProvider';\r\n\r\nconst OAuthControl = () => {\r\n    const { signOut, signIn, credential, userData } = useContext(\r\n        EsriOAuthContext\r\n    );\r\n\r\n    const getBtnLabel = () => {\r\n        if (!credential) {\r\n            return <span>Sign In</span>;\r\n        }\r\n\r\n        const { name, image } = userData;\r\n\r\n        return (\r\n            <span>\r\n                <b>Sign Out</b> as {name}\r\n            </span>\r\n        );\r\n    };\r\n\r\n    const onClickHandler = () => {\r\n        if (!credential) {\r\n            signIn();\r\n        } else {\r\n            signOut();\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"absolute top-2 right-2\" onClick={onClickHandler}>\r\n            <div className=\"text-white text-sm cursor-pointer\">\r\n                {getBtnLabel()}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default OAuthControl;\r\n","import React, { useRef } from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport { isControlPanelVisibleToggled } from '../../store/reducers/UI';\r\nimport PanelConfiguration from './PanelConfiguration';\r\nimport WebMapSelector from './WebMapSelector';\r\nimport useOnClickOutside from '../../hooks/useOnClickOutside';\r\nimport OAuthControl from './OAuthControl';\r\n\r\nconst Title = () => {\r\n    return (\r\n        <div className=\"text-xl\">\r\n            <h5>\r\n                {/* Living Atlas{' '} */}\r\n                <span className=\"font-medium text-white\">Optica</span>\r\n            </h5>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst CloseBtn = () => {\r\n    const dispatch = useDispatch();\r\n\r\n    const onClickHandler = () => {\r\n        dispatch(isControlPanelVisibleToggled());\r\n    };\r\n\r\n    return (\r\n        <div\r\n            className=\"absolute top-1 left-1 text-white cursor-pointer\"\r\n            onClick={onClickHandler}\r\n        >\r\n            <svg\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                viewBox=\"0 0 32 32\"\r\n                height=\"32\"\r\n                width=\"32\"\r\n                className=\"fill-current\"\r\n            >\r\n                <path d=\"M23.985 8.722L16.707 16l7.278 7.278-.707.707L16 16.707l-7.278 7.278-.707-.707L15.293 16 8.015 8.722l.707-.707L16 15.293l7.278-7.278z\" />\r\n                <path fill=\"none\" d=\"M0 0h32v32H0z\" />\r\n            </svg>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst ControlPanel = () => {\r\n    const dispatch = useDispatch();\r\n\r\n    const containerRef = useRef<HTMLDivElement>();\r\n\r\n    const handleClickOutside = () => {\r\n        dispatch(isControlPanelVisibleToggled());\r\n    };\r\n\r\n    useOnClickOutside(containerRef, handleClickOutside);\r\n\r\n    return (\r\n        <div\r\n            ref={containerRef}\r\n            className=\"absolute top-0 left-0 right-0 py-2 pb-4 px-14 text-gray-200 z-10 animate-fade-in\"\r\n            style={{\r\n                background: `\r\n                    linear-gradient(\r\n                        to bottom,\r\n                        rgba(0, 0, 0, 1) 0%,\r\n                        rgba(0, 0, 0, .6) 100%\r\n                    )\r\n                `,\r\n            }}\r\n        >\r\n            <Title />\r\n\r\n            <CloseBtn />\r\n\r\n            <OAuthControl />\r\n\r\n            <div className=\"md:flex mt-6\">\r\n                <PanelConfiguration />\r\n                <WebMapSelector />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ControlPanel;\r\n","import React from 'react';\r\n\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport ControlPanel from './ControlPanel';\r\nimport { isControlPanelVisibleSelector } from '../../store/reducers/UI';\r\n\r\nconst ControlPanelContainer = () => {\r\n    const isVisible = useSelector(isControlPanelVisibleSelector);\r\n\r\n    if (!isVisible) {\r\n        return null;\r\n    }\r\n\r\n    return <ControlPanel />;\r\n};\r\n\r\nexport default ControlPanelContainer;\r\n","import React, { useEffect, useLayoutEffect, useRef } from 'react';\r\n\r\nimport { loadModules, loadCss } from 'esri-loader';\r\nimport IMapView from 'esri/views/MapView';\r\nimport IWebMap from 'esri/WebMap';\r\nimport IPoint from 'esri/geometry/Point';\r\nimport IExtent from 'esri/geometry/Extent';\r\nimport IwatchUtils from 'esri/core/watchUtils';\r\nimport IZoom from 'esri/widgets/Zoom';\r\nimport { MapCenter } from '../../store/reducers/Map';\r\nimport { setHashParam } from '../../utils/URLHashParams';\r\n\r\nloadCss('https://js.arcgis.com/4.21/esri/themes/dark/main.css');\r\n\r\ninterface Props {\r\n    webmapId: string;\r\n    center: MapCenter;\r\n    zoom: number;\r\n    isActiveMapPanel: boolean;\r\n    shouldHideAttribution: boolean;\r\n    centerOnChange: (center: MapCenter) => void;\r\n    zoomOnChange: (zoom: number) => void;\r\n    scaleOnChange: (scale: number) => void;\r\n    extentOnChange: (extent: IExtent) => void;\r\n    children?: React.ReactNode;\r\n}\r\n\r\nconst ZOOM_STEP_FACTOR = 0.6;\r\n\r\nconst MapView: React.FC<Props> = ({\r\n    webmapId,\r\n    center,\r\n    zoom,\r\n    isActiveMapPanel,\r\n    shouldHideAttribution,\r\n    centerOnChange,\r\n    zoomOnChange,\r\n    extentOnChange,\r\n    scaleOnChange,\r\n    children,\r\n}: Props) => {\r\n    const mapDivRef = React.useRef<HTMLDivElement>();\r\n\r\n    const isActiveMapRef = useRef<boolean>(isActiveMapPanel);\r\n\r\n    const shouldTriggerExtentOnChangeRef = useRef<boolean>(true);\r\n\r\n    const mapContainerSizeRef = useRef<string>();\r\n\r\n    const [mapView, setMapView] = React.useState<IMapView>(null);\r\n\r\n    const initMapView = async () => {\r\n        type Modules = [typeof IMapView, typeof IWebMap, typeof IZoom];\r\n\r\n        try {\r\n            const [MapView, WebMap, Zoom] = await (loadModules([\r\n                'esri/views/MapView',\r\n                'esri/WebMap',\r\n                'esri/widgets/Zoom',\r\n                // 'esri/widgets/Attribution'\r\n            ]) as Promise<Modules>);\r\n\r\n            const { lon, lat } = center;\r\n\r\n            const view = new MapView({\r\n                container: mapDivRef.current,\r\n                map: new WebMap({\r\n                    portalItem: {\r\n                        id: webmapId,\r\n                    },\r\n                }),\r\n                zoom,\r\n                center: [lon, lat],\r\n                navigation: {\r\n                    mouseWheelZoomEnabled: false,\r\n                    browserTouchPanEnabled: false,\r\n                },\r\n                constraints: {\r\n                    rotationEnabled: false,\r\n                },\r\n                ui: {\r\n                    components: shouldHideAttribution ? [] : ['attribution'],\r\n                },\r\n                background: {\r\n                    color: '#000',\r\n                },\r\n            });\r\n\r\n            const zoomWidget = new Zoom({\r\n                view,\r\n            });\r\n\r\n            view.ui.add(zoomWidget, 'top-right');\r\n\r\n            view.when(() => {\r\n                setMapView(view);\r\n            });\r\n        } catch (err) {\r\n            console.error(err);\r\n        }\r\n    };\r\n\r\n    const updateWebmap = async () => {\r\n        type Modules = [typeof IWebMap];\r\n\r\n        try {\r\n            const [WebMap] = await (loadModules(['esri/WebMap']) as Promise<\r\n                Modules\r\n            >);\r\n\r\n            mapView.map = new WebMap({\r\n                portalItem: {\r\n                    id: webmapId,\r\n                },\r\n            });\r\n        } catch (err) {\r\n            console.error(err);\r\n        }\r\n    };\r\n\r\n    const canZoomRef = useRef<boolean>(true);\r\n\r\n    // the type of the input view is IMapView, setting it to any because need to access the view.mapViewNavigation object, which is a private property,\r\n    // therefore has to use any as it's type so the IDE won't throw error\r\n    const addMouseWheelEvent = async (view: any) => {\r\n        view.on('mouse-wheel', (event: WheelEvent) => {\r\n            if (!canZoomRef.current) {\r\n                return;\r\n            }\r\n\r\n            const navigation = view.mapViewNavigation;\r\n\r\n            // deltaY value is positive when wheel is scrolled up\r\n            // and it is negative when wheel is scrolled down.\r\n            const { deltaY } = event;\r\n            const scaleFactor = 1 / ZOOM_STEP_FACTOR ** ((1 / 60) * deltaY);\r\n            const promise = navigation.zoom(scaleFactor);\r\n\r\n            if (promise) {\r\n                canZoomRef.current = false;\r\n                promise\r\n                    //   .catch(() => {})\r\n                    .then(() => {\r\n                        canZoomRef.current = true;\r\n                        navigation.end();\r\n                    });\r\n            }\r\n        });\r\n    };\r\n\r\n    const addWatchEvent = async () => {\r\n        type Modules = [typeof IwatchUtils];\r\n\r\n        try {\r\n            const [watchUtils] = await (loadModules([\r\n                'esri/core/watchUtils',\r\n            ]) as Promise<Modules>);\r\n\r\n            // watchUtils.watch(mapView, 'zoom', (zoom: number) => {\r\n            //     // console.log('zoom on change', zoom)\r\n            //     shouldTriggerExtentOnChangeRef.current = true;\r\n            // });\r\n\r\n            watchUtils.watch(mapView, 'center', (center: IPoint) => {\r\n                // console.log('map center on change', center)\r\n                const { longitude, latitude } = center;\r\n\r\n                if (isActiveMapRef.current) {\r\n                    centerOnChange({\r\n                        lon: longitude,\r\n                        lat: latitude,\r\n                    });\r\n                }\r\n            });\r\n\r\n            watchUtils.whenTrue(mapView, 'stationary', () => {\r\n                if (mapView.zoom === -1) {\r\n                    return;\r\n                }\r\n\r\n                if (isActiveMapRef.current) {\r\n                    extentOnChange(mapView.extent);\r\n                    zoomOnChange(mapView.zoom);\r\n\r\n                    const { longitude, latitude } = mapView.center;\r\n                    setHashParam(\r\n                        'center',\r\n                        `${longitude.toFixed(3)},${latitude.toFixed(3)}`\r\n                    );\r\n                }\r\n\r\n                const containerSize = `${mapView.width}#${mapView.height}`;\r\n                // console.log(containerSize, mapContainerSizeRef.current)\r\n\r\n                if (\r\n                    shouldTriggerExtentOnChangeRef.current ||\r\n                    mapContainerSizeRef.current !== containerSize\r\n                ) {\r\n                    shouldTriggerExtentOnChangeRef.current = false;\r\n                    mapContainerSizeRef.current = containerSize;\r\n                    extentOnChange(mapView.extent);\r\n                }\r\n\r\n                scaleOnChange(mapView.scale);\r\n            });\r\n        } catch (err) {\r\n            console.error(err);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        initMapView();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (mapView) {\r\n            addWatchEvent();\r\n            addMouseWheelEvent(mapView);\r\n        }\r\n    }, [mapView]);\r\n\r\n    useEffect(() => {\r\n        if (!mapView || isActiveMapPanel) {\r\n            return;\r\n        }\r\n\r\n        const { lon, lat } = center;\r\n\r\n        mapView.goTo(\r\n            {\r\n                center: [lon, lat],\r\n            },\r\n            {\r\n                duration: 100,\r\n            }\r\n        );\r\n    }, [center, mapView]);\r\n\r\n    useEffect(() => {\r\n        if (!mapView) {\r\n            return;\r\n        }\r\n\r\n        if (mapView.zoom === zoom) {\r\n            return;\r\n        }\r\n\r\n        shouldTriggerExtentOnChangeRef.current = true;\r\n\r\n        mapView.goTo({\r\n            zoom,\r\n        });\r\n    }, [zoom]);\r\n\r\n    useEffect(() => {\r\n        isActiveMapRef.current = isActiveMapPanel;\r\n    }, [isActiveMapPanel]);\r\n\r\n    useEffect(() => {\r\n        if (!mapView) {\r\n            return;\r\n        }\r\n\r\n        updateWebmap();\r\n    }, [webmapId]);\r\n\r\n    return (\r\n        <>\r\n            <div\r\n                style={{\r\n                    position: 'absolute',\r\n                    top: 0,\r\n                    left: 0,\r\n                    bottom: 0,\r\n                    right: 0,\r\n                }}\r\n                ref={mapDivRef}\r\n            ></div>\r\n            {mapView\r\n                ? React.Children.map(children, (child) => {\r\n                      return React.cloneElement(\r\n                          child as React.ReactElement<any>,\r\n                          {\r\n                              mapView,\r\n                          }\r\n                      );\r\n                  })\r\n                : null}\r\n        </>\r\n    );\r\n};\r\n\r\nexport default MapView;\r\n","import React, { CSSProperties, FC, useEffect, useRef, useState } from 'react';\r\nimport './ExtentBox.css';\r\n\r\nimport IMapView from 'esri/views/MapView';\r\nimport IPoint from 'esri/geometry/Point';\r\nimport { loadModules } from 'esri-loader';\r\nimport { useSelector } from 'react-redux';\r\nimport {\r\n    extentsSelector,\r\n    // relativeZoomLevelsSelector,\r\n    // zoomLevelsSelector,\r\n} from '../../store/reducers/Map';\r\n// import { usePrevious } from '../../hooks/usePrevious';\r\nimport IwatchUtils from 'esri/core/watchUtils';\r\nimport classnames from 'classnames';\r\nimport { mapPanelsInfoSelector } from '../../store/reducers/UI';\r\n\r\ntype IExtent = {\r\n    xmin: number;\r\n    ymin: number;\r\n    xmax: number;\r\n    ymax: number;\r\n    spatialReference: any;\r\n};\r\n\r\ntype Props = {\r\n    // extent: IExtent;\r\n    indexOfTargetMap: number;\r\n    indexOfContainerMap: number;\r\n    mapView?: IMapView;\r\n};\r\n\r\ntype BoxPosition = {\r\n    top: number;\r\n    left: number;\r\n    height: number;\r\n    width: number;\r\n};\r\n\r\nconst ExtentBox: FC<Props> = ({\r\n    // extent,\r\n    indexOfTargetMap,\r\n    indexOfContainerMap,\r\n    mapView,\r\n}: Props) => {\r\n    const containerRef = useRef<HTMLDivElement>();\r\n\r\n    const extents = useSelector(extentsSelector);\r\n\r\n    // const relativeZoomLevels = useSelector(relativeZoomLevelsSelector);\r\n\r\n    const { direction } = useSelector(mapPanelsInfoSelector);\r\n\r\n    const extentOfTargetMapRef = useRef<string>();\r\n\r\n    const prevZoomRef = useRef<number>();\r\n\r\n    const [pos, setPos] = useState<BoxPosition>();\r\n\r\n    const calcPos = async (extentString: string) => {\r\n        type Modules = [typeof IPoint];\r\n\r\n        const extent: IExtent = extentString ? JSON.parse(extentString) : null;\r\n\r\n        // console.log('calling calcPos', extent);\r\n\r\n        if (!extent) {\r\n            setPos(null);\r\n            return;\r\n        }\r\n\r\n        const { xmin, ymin, xmax, ymax, spatialReference } = extent;\r\n\r\n        try {\r\n            const [Point] = await (loadModules([\r\n                'esri/geometry/Point',\r\n            ]) as Promise<Modules>);\r\n\r\n            const pointMin: IPoint = new Point({\r\n                x: xmin,\r\n                y: ymin,\r\n                spatialReference,\r\n            });\r\n\r\n            const pointMax: IPoint = new Point({\r\n                x: xmax,\r\n                y: ymax,\r\n                spatialReference,\r\n            });\r\n\r\n            const screenPointMin = mapView.toScreen(pointMin);\r\n            const screenPointMax = mapView.toScreen(pointMax);\r\n\r\n            setPos({\r\n                left: screenPointMin.x,\r\n                top: screenPointMax.y,\r\n                width: Math.abs(screenPointMax.x - screenPointMin.x),\r\n                height: Math.abs(screenPointMax.y - screenPointMin.y),\r\n            });\r\n\r\n            // console.log(screenPointMin, screenPointMax)\r\n        } catch (err) {}\r\n    };\r\n\r\n    const addWatchEvent = async (mapView: IMapView) => {\r\n        type Modules = [typeof IwatchUtils];\r\n\r\n        try {\r\n            const [watchUtils] = await (loadModules([\r\n                'esri/core/watchUtils',\r\n            ]) as Promise<Modules>);\r\n\r\n            watchUtils.whenTrue(mapView, 'stationary', () => {\r\n                if (prevZoomRef.current !== mapView.zoom) {\r\n                    calcPos(extentOfTargetMapRef.current);\r\n                }\r\n\r\n                prevZoomRef.current = mapView.zoom;\r\n            });\r\n        } catch (err) {\r\n            console.error(err);\r\n        }\r\n    };\r\n\r\n    // useEffect(() => {\r\n    //     // console.log(zoomLevels)\r\n    // }, [zoomLevels]);\r\n\r\n    useEffect(() => {\r\n        if (mapView) {\r\n            addWatchEvent(mapView);\r\n        }\r\n    }, [mapView]);\r\n\r\n    useEffect(() => {\r\n        if (extentOfTargetMapRef.current === extents[indexOfTargetMap]) {\r\n            return;\r\n        }\r\n\r\n        // check if the extent change is triggered by center change\r\n        if (extentOfTargetMapRef.current) {\r\n            // current extent\r\n            const ext1 = JSON.parse(extentOfTargetMapRef.current) as IExtent;\r\n            // new extent\r\n            const ext2 = JSON.parse(extents[indexOfTargetMap]) as IExtent;\r\n\r\n            const diffX1 = Math.floor(Math.abs(ext1.xmin - ext1.xmax));\r\n            const diffY1 = Math.floor(Math.abs(ext1.ymin - ext1.ymax));\r\n\r\n            const diffX2 = Math.floor(Math.abs(ext2.xmin - ext2.xmax));\r\n            const diffY2 = Math.floor(Math.abs(ext2.ymin - ext2.ymax));\r\n\r\n            if (diffX1 === diffX2 && diffY1 === diffY2) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        extentOfTargetMapRef.current = extents[indexOfTargetMap];\r\n\r\n        calcPos(extentOfTargetMapRef.current);\r\n    }, [extents]);\r\n\r\n    const getStyle = (): CSSProperties => {\r\n        const { top, left, height, width } = pos;\r\n\r\n        if (top < 0 || left < 0) {\r\n            return {\r\n                display: 'none',\r\n            };\r\n        }\r\n\r\n        return {\r\n            top,\r\n            left,\r\n            height,\r\n            width,\r\n            display: 'block',\r\n            boxShadow: '0 0 5px 2px rgba(0,0,0,.75)',\r\n        };\r\n    };\r\n\r\n    if (!mapView || !pos) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <div\r\n            ref={containerRef}\r\n            className={classnames(\r\n                'absolute border border-white border-opacity-50 pointer-events-none',\r\n                {\r\n                    'arrow-horizontal': direction === 'horizontal',\r\n                    'arrow-vertical': direction === 'vertical',\r\n                    'to-left': indexOfTargetMap < indexOfContainerMap,\r\n                    'to-right': indexOfTargetMap > indexOfContainerMap,\r\n                    'to-top': indexOfTargetMap < indexOfContainerMap,\r\n                    'to-bottom': indexOfTargetMap > indexOfContainerMap,\r\n                }\r\n            )}\r\n            style={getStyle()}\r\n        ></div>\r\n    );\r\n};\r\n\r\nexport default ExtentBox;\r\n","import React, { useCallback, useEffect, useMemo } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\n\r\nimport {\r\n    MapCenter,\r\n    mapCenterChanged,\r\n    MapCenterSelector,\r\n    webmapIdSelector,\r\n    updateZoomLevels,\r\n    updateExtents,\r\n    extentsSelector,\r\n    updateScale,\r\n} from '../../store/reducers/Map';\r\nimport { mapPanelsInfoSelector } from '../../store/reducers/UI';\r\nimport { MapView } from '../ArcGIS';\r\nimport ExtentBox from './ExtentBox';\r\n\r\ntype Props = {\r\n    isActivePanel: boolean;\r\n    zoom: number;\r\n    index: number;\r\n    shouldHideAttribution: boolean;\r\n};\r\n\r\nconst MapPanel: React.FC<Props> = ({\r\n    isActivePanel,\r\n    zoom,\r\n    index,\r\n    shouldHideAttribution,\r\n}: Props) => {\r\n    const dispatch = useDispatch();\r\n\r\n    const webmapId = useSelector(webmapIdSelector);\r\n\r\n    const center = useSelector(MapCenterSelector);\r\n\r\n    // const extents = useSelector(extentsSelector);\r\n\r\n    const panelInfo = useSelector(mapPanelsInfoSelector);\r\n\r\n    const getExtentBoxes = () => {\r\n        const extentBoxes: JSX.Element[] = [];\r\n\r\n        for (let i = index - 1; i <= index + 1; i++) {\r\n            if (i === index || i === panelInfo.num || i < 0) {\r\n                continue;\r\n            }\r\n\r\n            // if (extents[i]) {\r\n            //     const extent = JSON.parse(extents[i]);\r\n\r\n            //     extentBoxes.push(\r\n            //         <ExtentBox key={extents[i] + i} extent={extent} />\r\n            //     );\r\n            // }\r\n\r\n            extentBoxes.push(\r\n                <ExtentBox\r\n                    key={i}\r\n                    indexOfContainerMap={index}\r\n                    indexOfTargetMap={i}\r\n                />\r\n            );\r\n        }\r\n\r\n        return extentBoxes;\r\n    };\r\n\r\n    return (\r\n        <MapView\r\n            webmapId={webmapId}\r\n            center={center}\r\n            zoom={zoom}\r\n            isActiveMapPanel={isActivePanel}\r\n            shouldHideAttribution={shouldHideAttribution}\r\n            centerOnChange={(center: MapCenter) => {\r\n                dispatch(mapCenterChanged(center));\r\n            }}\r\n            zoomOnChange={(newZoom) => {\r\n                dispatch(updateZoomLevels(newZoom, index));\r\n            }}\r\n            extentOnChange={(extent) => {\r\n                // console.log('extent on change', extent)\r\n                dispatch(updateExtents(extent, index));\r\n            }}\r\n            scaleOnChange={(scale) => {\r\n                dispatch(updateScale(scale, index));\r\n            }}\r\n        >\r\n            {getExtentBoxes()}\r\n        </MapView>\r\n    );\r\n};\r\n\r\nexport default MapPanel;\r\n","import React from 'react';\r\n// import { MapPanelsDirection } from '../../store/reducers/UI';\r\n// import classnames from 'classnames';\r\n\r\nconst LockedIcon: JSX.Element = (\r\n    <svg\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        viewBox=\"0 0 16 16\"\r\n        width=\"16\"\r\n        height=\"16\"\r\n        className=\"fill-current\"\r\n    >\r\n        <path d=\"M8 1a4.012 4.012 0 0 0-4 4v2H3a1.003 1.003 0 0 0-1 1v7a1.003 1.003 0 0 0 1 1h10a1.003 1.003 0 0 0 1-1V8a1.003 1.003 0 0 0-1-1h-1V5a4.012 4.012 0 0 0-4-4zM5 5a3 3 0 0 1 6 0v2h-1V5a2 2 0 0 0-4 0v2H5zm4 2H7V5a1 1 0 0 1 2 0zm4 1v7H3V8zm-5 2h1v1H8v1h1v1H8v1H7V9h1z\" />\r\n    </svg>\r\n);\r\n\r\nconst UnlockedIcon: JSX.Element = (\r\n    <svg\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        viewBox=\"0 0 16 16\"\r\n        width=\"16\"\r\n        height=\"16\"\r\n        className=\"fill-current\"\r\n    >\r\n        <path d=\"M16 6V4a4 4 0 1 0-8 0v3H2a1.003 1.003 0 0 0-1 1v7a1.003 1.003 0 0 0 1 1h10a1.003 1.003 0 0 0 1-1V8a1.003 1.003 0 0 0-1-1h-1V4a1 1 0 0 1 2 0v2zm-4 2v7H2V8zm0-6a2 2 0 0 0-2 2v3H9V4a3 3 0 1 1 6 0v1h-1V4a2 2 0 0 0-2-2zM7 14H6V9h1v1h1v1H7v1h1v1H7z\" />\r\n    </svg>\r\n);\r\n\r\ntype Props = {\r\n    placeOnLeftSide: boolean;\r\n    isUnlocked: boolean;\r\n    onClick: () => void;\r\n};\r\n\r\nconst SIZE = 40;\r\n\r\nconst ZoomLock: React.FC<Props> = ({\r\n    placeOnLeftSide,\r\n    isUnlocked,\r\n    onClick,\r\n}: Props) => {\r\n    return (\r\n        <div\r\n            className=\"absolute bg-white text-black opacity-90 z-10 p-2 cursor-pointer flex\"\r\n            style={{\r\n                bottom: -(SIZE / 2),\r\n                left: placeOnLeftSide\r\n                    ? -(SIZE / 2)\r\n                    : `calc(100% - ${SIZE / 2}px)`,\r\n                justifyContent: placeOnLeftSide ? 'flex-end' : 'center',\r\n                alignItems: placeOnLeftSide ? 'center' : 'flex-start',\r\n                width: SIZE,\r\n                height: SIZE,\r\n                borderRadius: '50%',\r\n                boxShadow: '0 0 10px #000',\r\n            }}\r\n            onClick={onClick}\r\n        >\r\n            <div\r\n                className=\"absolute\"\r\n                style={{\r\n                    top: placeOnLeftSide ? 'unset' : 2,\r\n                    right: placeOnLeftSide ? 2 : 'unset',\r\n                }}\r\n            >\r\n                {isUnlocked ? UnlockedIcon : LockedIcon}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ZoomLock;\r\n","import React from 'react';\r\n\r\nimport { numberFns } from 'helper-toolkit-ts';\r\n\r\ntype Props = {\r\n    scale?: number;\r\n};\r\n\r\nconst ScaleIndicator: React.FC<Props> = ({ scale }: Props) => {\r\n    if (scale === 0) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <div\r\n            className=\"absolute top-0 left-0 right-0 py-1 text-white text-center italic text-sm font-medium\"\r\n            style={{\r\n                background: `\r\n                    linear-gradient(\r\n                        to bottom,\r\n                        rgba(0, 0, 0, 1) 0%,\r\n                        rgba(0, 0, 0, .1) 80%,\r\n                        rgba(0, 0, 0, 0) 100%)\r\n                    `,\r\n                textShadow: `0px 0px 6px black`,\r\n            }}\r\n        >\r\n            1:{numberFns.numberWithCommas(+scale.toFixed())}\r\n        </div>\r\n    );\r\n\r\n    // return null;\r\n};\r\n\r\nexport default ScaleIndicator;\r\n","import React, { useEffect, useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport {\r\n    indexOfActiveMapPanelChanged,\r\n    indexOfActiveMapPanelSelector,\r\n    relativeZoomLevelsSelector,\r\n    scalesSelector,\r\n    toggleLockRelativeZoomLevels,\r\n    zoomLevelsSelector,\r\n} from '../../store/reducers/Map';\r\nimport { mapPanelsInfoSelector } from '../../store/reducers/UI';\r\nimport MapPanel from './MapPanel';\r\nimport classnames from 'classnames';\r\nimport ZoomLock from './ZoomLock';\r\nimport ScaleIndicator from './ScaleIndicator';\r\n\r\nconst MapPanelsContainer = () => {\r\n    const dispatch = useDispatch();\r\n\r\n    const { num, direction } = useSelector(mapPanelsInfoSelector);\r\n\r\n    const isHorizontal = direction === 'horizontal';\r\n\r\n    const idxOfActiveMapPanel = useSelector(indexOfActiveMapPanelSelector);\r\n\r\n    // const [ relativeZoomLevels, setRelativeZoomLevels] = useState<number[]>(relativeZoomLevelLookup[0])\r\n\r\n    const zoomLevels = useSelector(zoomLevelsSelector);\r\n\r\n    const scales = useSelector(scalesSelector);\r\n\r\n    const relativeZoomLevels = useSelector(relativeZoomLevelsSelector);\r\n\r\n    const getPanels = () => {\r\n        // const { num } = panelsInfo;\r\n\r\n        const panels = [];\r\n\r\n        for (let i = 0; i < num; i++) {\r\n            const zoom = zoomLevels[i];\r\n\r\n            const shouldShowZoomLock = i < num - 1;\r\n\r\n            const shouldShowBorder = i === 1;\r\n\r\n            const classNames = classnames('relative', {\r\n                'h-1/2': !isHorizontal && num === 2,\r\n                'h-1/3': !isHorizontal && num === 3,\r\n                'w-1/2': isHorizontal && num === 2,\r\n                'w-1/3': isHorizontal && num === 3,\r\n                'border-l': shouldShowBorder && direction === 'horizontal',\r\n                'border-r':\r\n                    shouldShowBorder && direction === 'horizontal' && num > 2,\r\n                'border-t': shouldShowBorder && direction === 'vertical',\r\n                'border-b':\r\n                    shouldShowBorder && direction === 'vertical' && num > 2,\r\n                'border-white border-opacity-50': shouldShowBorder,\r\n            });\r\n\r\n            panels.push(\r\n                <div\r\n                    className={classNames}\r\n                    key={i}\r\n                    onMouseEnter={() => {\r\n                        dispatch(indexOfActiveMapPanelChanged(i));\r\n                    }}\r\n                    // style={{\r\n                    //     'boxShadow': '-2px 0 5px 5px rgba(0,0,0,.75)'\r\n                    // }}\r\n                >\r\n                    <MapPanel\r\n                        index={i}\r\n                        isActivePanel={idxOfActiveMapPanel === i}\r\n                        zoom={zoom}\r\n                        shouldHideAttribution={i < num - 1}\r\n                    />\r\n\r\n                    <ScaleIndicator scale={scales[i]} />\r\n\r\n                    {shouldShowZoomLock && (\r\n                        <ZoomLock\r\n                            placeOnLeftSide={direction === 'vertical'}\r\n                            isUnlocked={\r\n                                relativeZoomLevels[i] === null ||\r\n                                relativeZoomLevels[i + 1] === null\r\n                            }\r\n                            onClick={() => {\r\n                                // console.log(i)\r\n                                dispatch(toggleLockRelativeZoomLevels(i));\r\n                            }}\r\n                        />\r\n                    )}\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return panels;\r\n    };\r\n\r\n    // useEffect(()=>{\r\n    //     console.log('idxOfActiveMapPanel', idxOfActiveMapPanel)\r\n\r\n    //     if(idxOfActiveMapPanel > -1){\r\n    //         setRelativeZoomLevels(relativeZoomLevelLookup[idxOfActiveMapPanel])\r\n    //     }\r\n\r\n    // }, [idxOfActiveMapPanel]);\r\n\r\n    return (\r\n        <div\r\n            className={classnames('flex h-screen overflow-hidden', {\r\n                'flex-col': !isHorizontal,\r\n            })}\r\n        >\r\n            {getPanels()}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default MapPanelsContainer;\r\n","import './styles/index.css';\r\n\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { Provider as ReduxProvider } from 'react-redux';\r\n\r\nimport configureAppStore, { getPreloadedState } from './store/configureStore';\r\n\r\nimport AppContextProvider from './contexts/AppContextProvider';\r\nimport EsriOAuthProvider from './contexts/EsriOAuthProvider';\r\n\r\nimport { AppLayout } from './components';\r\nimport { APP_ID } from './constants/map';\r\n\r\n(async () => {\r\n    const preloadedState = getPreloadedState();\r\n\r\n    ReactDOM.render(\r\n        <React.StrictMode>\r\n            <ReduxProvider store={configureAppStore(preloadedState)}>\r\n                <AppContextProvider>\r\n                    <EsriOAuthProvider appId={APP_ID}>\r\n                        <AppLayout />\r\n                    </EsriOAuthProvider>\r\n                </AppContextProvider>\r\n            </ReduxProvider>\r\n        </React.StrictMode>,\r\n        document.getElementById('root')\r\n    );\r\n})();\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t179: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tfor(moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) var result = runtime(__webpack_require__);\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkIds[i]] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkliving_atlas_optica\"] = self[\"webpackChunkliving_atlas_optica\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [736], () => (__webpack_require__(8056)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"sourceRoot":""}